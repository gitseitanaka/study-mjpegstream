<!DOCTYPE html>
<html>
<head>
    <title>Motion JPEG(MJPEG)</title>
<style type="text/css">
    #stream {
        display: none;
    }
    .stop {
       display: none;
    }
</style>
<!-- jQuery -->
<script src="http://code.jquery.com/jquery.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
var socket = io();
var isLive = false;
socket.on('connected',function(id) {
    socket.emit('stop-stream');
    $('.start').show();
    $('.stop').hide();
    var idString = id;
    if (isLive) {
        idString = idString + ' [now reconnected]';
        isLive = false;
    }
    $('#start_id').text(idString);
});
socket.on('disconnect', function(){
  $('#stream').hide();
  $('.start').hide();
  $('.stop').hide();
  $('#start_id').text('[now server down..]');
});
socket.on('liveStream', function(url, id) {
    if (!isLive) {
        $('#stream').show();
        isLive = true;
    }
    $('#stream').attr('src', url);
    $('.start').hide();
    $('.stop').show();
    $('#start_id').text(id);
});
socket.on('liveStopped', function () {
    $('.start').show();
    $('.stop').hide();
});
function startStream() {
    socket.emit('start-stream');
    $('.start').hide();
    $('.stop').show();
}
function stopStream() {
    socket.emit('stop-stream');
    $('.start').show();
    $('.stop').hide();
}

</script>
</head>
<body>
<h1>mjpeg test</h1>
<hr>
<div>
<p id="start_id"></p>
</div>
<hr>
<button type="button" id="" class="btn start" onclick="startStream()">Start</button>
<button type="button" id="" class="btn stop" onclick="stopStream()">Stop</button>
<div class="row">
<img src="" id="stream">
</div>
</body>
</html>
